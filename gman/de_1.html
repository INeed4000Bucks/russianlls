<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>DE 1 - Genie</title>
  <link rel="stylesheet" href="flash-style.css" />
</head>

<body>
<div id="container">
  <div id="flashcard">
    <h1 id="word" style="font-size: 40px; font-family: 'PingFang SC'">Word goes here</h1>
    <h1 id="definition" style="font-family: 'Baloo Bhaina 2 Regular';">Definition goes here</h1>
  </div>
  <div id="button-container">
    <button class="button" id="left-button">Translate</button>
    <button class="button" id="right-button">I got it right</button>
    <button class="button" id="next-button">Next words</button>
    <input type="number" class="set-num" id="set-num" min="1" max="1000">
  </div>

</div>

<script>
  const lessonWords = [
    {word: "jedes", definition: "each", score: 0},
    {word: "wenn", definition: "if", score: 0},
    {word: "Besuch", definition: "Visit", score: 0},
    {word: "nachts", definition: "at night", score: 0},
    {word: "lautes", definition: "loud", score: 0},
    {word: "Stöhnen", definition: "Moan", score: 0},
    {word: "durch", definition: "through", score: 0},
    {word: "dünnen", definition: "thin", score: 0},
    {word: "Wände", definition: "walls", score: 0},
    {word: "Manchmal", definition: "Sometimes", score: 0},
    {word: "stundenlang", definition: "for hours", score: 0},
    {word: "vorstellt", definition: "imagines", score: 0},
    {word: "dann", definition: "then", score: 0},
    {word: "vor", definition: "before", score: 0},
    {word: "schön", definition: "nice", score: 0},
    {word: "wunderschönen", definition: "beautiful", score: 0},
    {word: "Modelkörper", definition: "Model body", score: 0},
    {word: "ficken", definition: "fuck", score: 0},
    {word: "nasse", definition: "wet", score: 0},
    {word: "Spalte", definition: "Split", score: 0},
    {word: "bis", definition: "until", score: 0},
    {word: "zur", definition: "to", score: 0},
    {word: "Ekstase", definition: "ecstasy", score: 0},
    {word: "rammeln", definition: "ramming", score: 0},
    {word: "Sperma", definition: "sperm", score: 0},
    {word: "perfekten", definition: "perfect", score: 0},
    {word: "Gesicht", definition: "Face", score: 0},
    {word: "verteilen", definition: "distribute", score: 0},
    {word: "grüßte", definition: "greeted", score: 0},
    {word: "ihn", definition: "him", score: 0},
    {word: "sondern", definition: "rather", score: 0},
    {word: "grinste", definition: "grinned", score: 0},
    {word: "nur", definition: "only", score: 0},
    {word: "abfällig", definition: "derogatory", score: 0},
    {word: "an", definition: "at", score: 0},
    {word: "Verdammt", definition: "Damned", score: 0},
    {word: "enges", definition: "narrow", score: 0},
    {word: "kurzes", definition: "short", score: 0},
    {word: "Kleid", definition: "Dress", score: 0},
    {word: "wieder", definition: "again", score: 0},
    {word: "trägt", definition: "carries", score: 0},
    {word: "roten", definition: "redden", score: 0},
    {word: "Schon", definition: "Already", score: 0},
    {word: "schießt", definition: "shoots", score: 0},
    {word: "einmal", definition: "once", score: 0},
    {word: "das", definition: "the", score: 0},
    {word: "ganze", definition: "whole", score: 0},
    {word: "Blut", definition: "blood", score: 0},
    {word: "Pimmel", definition: "willie", score: 0},
    {word: "schafft", definition: "creates", score: 0},
    {word: "gerade", definition: "straight", score: 0},
    {word: "noch", definition: "still", score: 0},
    {word: "so", definition: "so", score: 0},
    {word: "Haustür", definition: "front door", score: 0},
    {word: "als", definition: "as", score: 0},
    {word: "älterer", definition: "older", score: 0},
    {word: "Wohnung", definition: "Apartment", score: 0},
    {word: "gegenüber", definition: "opposite", score: 0},
    {word: "öffnet", definition: "opens", score: 0},
    {word: "sollten", definition: "should", score: 0},
    {word: "eine", definition: "one", score: 0},
    {word: "bemitleidend", definition: "pitying", score: 0},
    {word: "deutet", definition: "indicates", score: 0},
    {word: "auf", definition: "on", score: 0},
    {word: "dessen", definition: "whose", score: 0},
    {word: "Beule", definition: "bump", score: 0},
    {word: "Hose", definition: "trousers", score: 0},
    {word: "versucht", definition: "tried", score: 0},
    {word: "gequälten", definition: "tortured", score: 0},
    {word: "Lachen", definition: "Laugh", score: 0},
    {word: "überspielen", definition: "transfer", score: 0},
    {word: "schnell", definition: "fast", score: 0},
    {word: "wurde", definition: "became", score: 0},
    {word: "abgegeben", definition: "delivered", score: 0},
    {word: "fügt", definition: "adds", score: 0},
    {word: "hinzu", definition: "in addition", score: 0},
    {word: "merkt", definition: "notices", score: 0},
    {word: "dass", definition: "that", score: 0},
    {word: "Art", definition: "type", score: 0},
    {word: "Sätze", definition: "sentences", score: 0},
    {word: "betont", definition: "emphasized", score: 0},
    {word: "reißt", definition: "tears", score: 0},
    {word: "Händen", definition: "hands", score: 0},
    {word: "stammelt", definition: "stammers", score: 0},
    {word: "heißeres", definition: "hotter", score: 0},
    {word: "seinem", definition: "his", score: 0},
    {word: "Nachbarn", definition: "Neighbors", score: 0},
    {word: "schließt", definition: "closes", score: 0},
    {word: "Ruck", definition: "shock", score: 0},
    {word: "Erst", definition: "First, just (recent)", score: 0},
    {word: "realisiert", definition: "realized", score: 0},
    {word: "eigentlich", definition: "actually", score: 0},
    {word: "gar", definition: "even", score: 0},
    {word: "bestellt", definition: "ordered", score: 0},
    {word: "Schnell", definition: "Fast", score: 0},
    {word: "reist", definition: "travels", score: 0},
    {word: "Zeitungspapier", definition: "Newspaper", score: 0},
    {word: "dort", definition: "there", score: 0},
    {word: "merkwürdige", definition: "strange", score: 0},
    {word: "Öllampe", definition: "oil lamp", score: 0},
    {word: "eingewickelt", definition: "wrapped up", score: 0},
    {word: "toll", definition: "Great", score: 0},
    {word: "soll", definition: "should", score: 0},
    {word: "denn", definition: "because", score: 0},
    {word: "bitte", definition: "please", score: 0},
    {word: "Sicherlich", definition: "Surely", score: 0},
    {word: "Schwachsinnsgeschenk", definition: "Bullshit gift", score: 0},
    {word: "seiner", definition: "his", score: 0},
    {word: "Genervt", definition: "Annoyed", score: 0},
    {word: "seinen", definition: "his", score: 0},
    {word: "Tisch", definition: "Table", score: 0},
    {word: "Noch", definition: "Still", score: 0},
    {word: "spukt", definition: "haunted", score: 0},
    {word: "geile", definition: "horny", score: 0},
    {word: "Anblick", definition: "sight", score: 0},
    {word: "Nachbarin", definition: "neighbor", score: 0},
    {word: "herum", definition: "around", score: 0},
    {word: "wichsen", definition: "jerk off", score: 0},
    {word: "laut", definition: "loud", score: 0},
    {word: "selbst", definition: "himself", score: 0},
    {word: "steifen", definition: "stiffen", score: 0},
    {word: "befreien", definition: "to free", score: 0},
    {word: "Verzweifelt", definition: "Desperate", score: 0},
    {word: "sucht", definition: "seeks", score: 0},
    {word: "Schreibtischschubladen", definition: "Desk drawers", score: 0},
    {word: "nach", definition: "after", score: 0}
];

const definition = document.getElementById("definition");
const word = document.getElementById("word");
let wordOnDisplay = false;
let currentWords = lessonWords.slice(0, 9);
let currentIndex = 0;
let setNum = 1;
let setSize = 9;
let dieRoll = 0;
let tapCount = 0;
//let timer;
let translateButtonTapped = false;

const exclamatories = ["Oops", "I Forgor", "RIP Memory", "Uh-Oh"];
let currentEx = 0; //Exclamatory at this index will be displayed next.
init();

function init() {
    // Display the first word and definition
    word.innerHTML = currentWords[0].word;
    definition.innerHTML = currentWords[0].definition;
    displaySetNum();
    // Event listeners for the buttons
    document.getElementById("left-button").addEventListener("touchstart", function () {
        if (translateButtonTapped === false) {
            translateButtonTapped = true;
        } else {
            translateButtonTapped = false;
        }
    });
    document.getElementById("left-button").addEventListener("click", function () {
        this.blur();

        if (wordOnDisplay === true) {
            // Move the current word back in the queue by 3 positions
            // or to the back if there are less than 4 words in the queue
            let currentWord = currentWords.shift();
            if (currentWords.length < 4) {
                currentWords.push(currentWord); //put it at the very end
                console.log(currentWords);
            } else {
                currentWords.splice(3, 0, currentWord);
                console.log(currentWords);
            }
            currentWord.score = -1;
            definition.style.visibility = "hidden";
            definition.style.textTransform = "lowercase";

            displayDone();
            displayNextWord();
            document.getElementById("left-button").innerHTML = "Translate";
            wordOnDisplay = false;
        } else {
            wordOnDisplay = true;
            definition.style.visibility = "visible";
            dieRoll = getRandomNumber();
            //If dieRoll < 98, display "Again" instead of an exclamatory remark

            if (dieRoll < 98) {
                document.getElementById("left-button").innerHTML = "Again";
            } else {
                if (currentEx > 3) {
                    currentEx = 0;
                }
                document.getElementById("left-button").innerHTML = exclamatories[currentEx];
                currentEx += 1;
            }
        }
    });

    document.getElementById("right-button").addEventListener("click", function () {
        this.blur();
        // Move the current word to the back of the queue
        let currentWord = currentWords.shift();
        currentWords.push(currentWord);
        currentWord.score++;
        // If the word's score is 2, remove it from the queue
        if (currentWord.score === 2) {
            currentWords = currentWords.filter((word) => word !== currentWord);
        }
        definition.style.visibility = "hidden";
        definition.style.textTransform = "lowercase";
        document.getElementById("left-button").innerHTML = "Translate";
        displayDone();
        displayNextWord();
        wordOnDisplay = false;
    });

    document.getElementById("next-button").addEventListener("click", function () {
        this.blur();
        // Load the next setSize words from the lessonWords array
        currentIndex += setSize;
        currentWords = lessonWords.slice(currentIndex, currentIndex + setSize);
        definition.style.visibility = "hidden";
        definition.style.textTransform = "lowercase";

        setNum += 1;

        displaySetNum();

        displayDone();
        displayNextWord();
        wordOnDisplay = false;
    });

    document.addEventListener("keydown", (event) => {
        // Check if the key that was pressed is the space key
        if (event.key === " ") {
            const numInput = document.getElementById("set-num");
            numInput.value = numInput.value.replaceAll(" ", "");
            if (wordOnDisplay === false) {
                displayDone();
                definition.style.visibility = "visible";
                wordOnDisplay = true;
                dieRoll = getRandomNumber();
                //If dieRoll < 98, display "Again" instead of an exclamatory remark
                if (dieRoll < 98) {
                    document.getElementById("left-button").innerHTML = "Again";
                } else {
                    if (currentEx > 3) {
                        currentEx = 0;
                    }
                    document.getElementById("left-button").innerHTML = exclamatories[currentEx];
                    currentEx += 1;
                }
            } else {
                let currentWord = currentWords.shift();
                currentWords.push(currentWord);
                currentWord.score++;
                // If the word's score is 2, remove it from the queue
                if (currentWord.score === 2) {
                    currentWords = currentWords.filter((word) => word !== currentWord);
                }
                definition.style.visibility = "hidden";
                definition.style.textTransform = "lowercase";
                document.getElementById("left-button").innerHTML = "Translate";
                displayDone();
                displayNextWord();
                wordOnDisplay = false;
            }
        }
        if (event.key === "Enter") {
            const numInput = document.getElementById("set-num");
            numInput.blur();
            displaySet();
        }
    });
    document.addEventListener("keydown", (event) => {
        // Check if the key that was pressed is the space key
        if (event.key !== "1") return;

        let currentWord = currentWords.shift();
        if (currentWords.length < 4) {
            currentWords.push(currentWord);
            console.log(currentWords);
        } else {
            currentWords.splice(3, 0, currentWord);
            console.log(currentWords);
        }
        currentWord.score = -1;
        definition.style.visibility = "hidden";
        definition.style.textTransform = "lowercase";

        displayDone();
        displayNextWord();
        wordOnDisplay = false;
    });

    document.addEventListener("touchend", (event) => {
        // Check if the event target is an input or textarea
        if (event.target.tagName === 'INPUT' || event.target.tagName === 'TEXTAREA') {
            return;
        }

        displayDone();
        if (translateButtonTapped === true) {
            translateButtonTapped = false;
            return;
        }
        if (wordOnDisplay === false) {
            displayDone();
            definition.style.visibility = "visible";
            wordOnDisplay = true;
            dieRoll = getRandomNumber();
            // If dieRoll < 98, display "Again" instead of an exclamatory remark
            if (dieRoll < 98) {
                document.getElementById("left-button").innerHTML = "Again";
            } else {
                if (currentEx > 3) {
                    currentEx = 0;
                }
                document.getElementById("left-button").innerHTML = exclamatories[currentEx];
                currentEx += 1;
            }
        }
    });

    document.addEventListener("touchstart", (event) => {
        tapCount++; // increment the tapCount variable when a tap is detected
    });
}
function displaySet() {
    const numInput = document.getElementById("set-num");
    setNum = parseInt(numInput.value);
    currentIndex = setNum * setSize - setSize;

    currentWords = lessonWords.slice(currentIndex, currentIndex + setSize);
    currentWords.forEach((word) => (word.score = 0));
    definition.style.visibility = "hidden";
    definition.style.textTransform = "lowercase";

    displaySetNum();

    displayDone();
    displayNextWord();
}

function displaySetNum() {
    //Find input box
    const numInput = document.getElementById("set-num");
    numInput.value = setNum;
}

function displayNextWord() {
    // Display the next word and definition
    let currentWord = currentWords[0];
    document.getElementById("word").innerHTML = currentWord.word;
    definition.innerHTML = currentWord.definition;
}

function displayDone() {
    if (currentWords.length !== 0) return;
    const definition = document.getElementById("definition");
    definition.style.visibility = "visible";
    definition.innerHTML = "Set Done " + setNum;
    //definition.style.textTransform = "capitalize";
}

function getRandomNumber() {
    return Math.floor(Math.random() * 100) + 1;
}
  </script>
</body>
</html>
